const axios = require('axios')

const FIXER_KEY = process.env['FIXER_KEY']
const ratesUrl = `http://data.fixer.io/api/latest?access_key=${FIXER_KEY}&base=EUR`

const getData = () =>
	process.env['VERCEL_URL']
		? axios.get(ratesUrl).json()
		: {
				data: {
					success: true,
					timestamp: 1595399345000,
					base: 'EUR',
					date: '2020-07-22',
					rates: {
						AED: 4.231282,
						AFN: 88.012833,
						ALL: 123.849494,
						AMD: 557.209439,
						ANG: 2.051151,
						AOA: 644.44835,
						ARS: 82.615679,
						AUD: 1.613466,
						AWG: 2.073554,
						AZN: 1.955376,
						BAM: 1.953946,
						BBD: 2.307375,
						BDT: 96.900164,
						BGN: 1.956031,
						BHD: 0.434294,
						BIF: 2201.488927,
						BMD: 1.151974,
						BND: 1.587542,
						BOB: 7.890723,
						BRL: 5.95663,
						BSD: 1.142788,
						BTC: 0.000123,
						BTN: 85.274567,
						BWP: 13.211446,
						BYN: 2.727693,
						BYR: 22578.694237,
						BZD: 2.303499,
						CAD: 1.55035,
						CDF: 2254.98709,
						CHF: 1.07447,
						CLF: 0.032213,
						CLP: 888.866858,
						CNY: 8.035945,
						COP: 4164.386718,
						CRC: 664.576098,
						CUC: 1.151974,
						CUP: 30.527316,
						CVE: 110.156865,
						CZK: 26.329289,
						DJF: 203.442064,
						DKK: 7.442975,
						DOP: 66.654413,
						DZD: 147.690047,
						EGP: 18.408201,
						ERN: 17.279806,
						ETB: 40.378112,
						EUR: 1,
						FJD: 2.44691,
						FKP: 0.906136,
						GBP: 0.906241,
						GEL: 3.553838,
						GGP: 0.906136,
						GHS: 6.570864,
						GIP: 0.906136,
						GMD: 59.695584,
						GNF: 11015.985955,
						GTQ: 8.796341,
						GYD: 238.569951,
						HKD: 8.929193,
						HNL: 28.281746,
						HRK: 7.527697,
						HTG: 126.083253,
						HUF: 350.135623,
						IDR: 16858.623967,
						ILS: 3.938372,
						IMP: 0.906136,
						INR: 86.04389,
						IQD: 1364.234427,
						IRR: 48503.873188,
						ISK: 158.096991,
						JEP: 0.906136,
						JMD: 166.835884,
						JOD: 0.816779,
						JPY: 123.091324,
						KES: 124.240282,
						KGS: 89.023889,
						KHR: 4678.630769,
						KMF: 492.180772,
						KPW: 1036.808021,
						KRW: 1376.747685,
						KWD: 0.353253,
						KYD: 0.952382,
						KZT: 472.474406,
						LAK: 10351.118331,
						LBP: 1727.848858,
						LKR: 212.294053,
						LRD: 229.562477,
						LSL: 19.180656,
						LTL: 3.401481,
						LVL: 0.696818,
						LYD: 1.588454,
						MAD: 10.909485,
						MDL: 19.409952,
						MGA: 4415.004418,
						MKD: 61.555644,
						MMK: 1587.848634,
						MNT: 3277.198628,
						MOP: 9.124701,
						MRO: 411.254916,
						MUR: 46.310634,
						MVR: 17.809678,
						MWK: 843.376453,
						MXN: 25.742522,
						MYR: 4.898773,
						MZN: 81.271738,
						NAD: 18.915122,
						NGN: 441.48299,
						NIO: 39.727003,
						NOK: 10.506189,
						NPR: 136.434697,
						NZD: 1.731803,
						OMR: 0.443516,
						PAB: 1.142788,
						PEN: 4.004804,
						PGK: 3.971267,
						PHP: 56.896577,
						PKR: 192.553051,
						PLN: 4.434122,
						PYG: 7909.073513,
						QAR: 4.194348,
						RON: 4.839916,
						RSD: 117.610834,
						RUB: 81.545605,
						RWF: 1094.206837,
						SAR: 4.319884,
						SBD: 9.587321,
						SCR: 20.326339,
						SDG: 63.761612,
						SEK: 10.242503,
						SGD: 1.594182,
						SHP: 0.906136,
						SLL: 11237.508196,
						SOS: 669.296994,
						SRD: 8.591465,
						STD: 25222.667404,
						SVC: 9.999357,
						SYP: 591.505804,
						SZL: 18.829679,
						THB: 36.413328,
						TJS: 11.764655,
						TMT: 4.03767,
						TND: 3.233018,
						TOP: 2.617919,
						TRY: 7.890608,
						TTD: 7.728448,
						TWD: 33.867466,
						TZS: 2671.427956,
						UAH: 31.634021,
						UGX: 4222.528352,
						USD: 1.151974,
						UYU: 49.971657,
						UZS: 11652.804187,
						VEF: 11.505342,
						VND: 26708.521729,
						VUV: 131.474723,
						WST: 3.014884,
						XAF: 655.30236,
						XAG: 0.051142,
						XAU: 0.000619,
						XCD: 3.113267,
						XDR: 0.8219,
						XOF: 655.319415,
						XPF: 119.661364,
						YER: 288.351482,
						ZAR: 18.958442,
						ZMK: 10369.146568,
						ZMW: 20.655382,
						ZWL: 370.935912,
					},
				},
		  }

module.exports = async (req, res) => {
	const { data } = await getData()

	res.setHeader('Cache-Control', 's-maxage=3600')

	res.json({
		...data,
		timestamp: data.timestamp,
	})
}
